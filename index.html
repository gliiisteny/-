<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>حروفكم مع عبدالعزيز</title>
    <style>
        body { text-align: center; font-family: Arial, sans-serif; background: #1a1a1a; color: #fff; }
        h1 { color: #00ccff; text-shadow: 0 0 10px #00ccff; }
        p { font-size: 18px; }
        .grid { display: grid; grid-template-columns: repeat(7, 90px); gap: 8px; justify-content: center; margin-top: 30px; }
        .hex { 
            width: 90px; height: 90px; 
            background: #333; 
            display: flex; align-items: center; justify-content: center; 
            border: 3px solid #fff; 
            clip-path: polygon(50% 0%, 95% 25%, 95% 75%, 50% 100%, 5% 75%, 5% 25%); 
            cursor: pointer; font-size: 32px; font-weight: bold; 
            color: #ffd700; font-family: 'Arial Black', sans-serif; 
            transition: transform 0.2s, background 0.3s; 
        }
        .hex:hover { transform: scale(1.1); }
        .player1 { background: #00b7eb; color: #fff; border-color: #00e6ff; }
        .player2 { background: #ff4040; color: #fff; border-color: #ff6666; }
        .edge-blue { background: #0077b6 !important; border-color: #00b7eb; }
        .edge-red { background: #d00000 !important; border-color: #ff4040; }
        #message { margin-top: 20px; font-size: 24px; font-weight: bold; }
    </style>
</head>
<body>
    <h1>حروفكم مع عبدالعزيز</h1>
    <p>اضغط على الخلية لتحديدها. الأزرق يفوز عند الربط عموديًا، والأحمر يفوز عند الربط أفقيًا!</p>
    <div class="grid" id="board"></div>
    <div id="message"></div>
    <script>
        const letters = ["ا", "ب", "ت", "ث", "ج", "ح", "خ", "د", "ذ", "ر", "ز", "س", "ش", "ص", "ض", "ط", "ظ", "ع", "غ", "ف", "ق", "ك", "ل", "م", "ن", "ه", "و", "ي"];
        const board = document.getElementById("board");
        const message = document.getElementById("message");
        const size = 7;
        let grid = [];
        let usedLetters = new Set();
        
        function createBoard() {
            usedLetters.clear();
            for (let row = 0; row < size; row++) {
                grid[row] = [];
                for (let col = 0; col < size; col++) {
                    let cell = document.createElement("div");
                    cell.classList.add("hex");
                    cell.dataset.row = row;
                    cell.dataset.col = col;
                    
                    if (row === 0 || row === size - 1) {
                        cell.classList.add("edge-blue");
                    } else if (col === 0 || col === size - 1) {
                        cell.classList.add("edge-red");
                    } else {
                        let letter;
                        do {
                            letter = letters[Math.floor(Math.random() * letters.length)];
                        } while (usedLetters.has(letter));
                        usedLetters.add(letter);
                        cell.innerText = letter;
                        cell.dataset.state = "0";
                        cell.addEventListener("click", () => selectCell(cell));
                    }
                    
                    board.appendChild(cell);
                    grid[row][col] = cell;
                }
            }
        }
        
        function selectCell(cell) {
            let state = parseInt(cell.dataset.state);
            if (state === 0) {
                cell.classList.add("player1");
                cell.dataset.state = "1";
                checkWin();
            } else if (state === 1) {
                cell.classList.remove("player1");
                cell.classList.add("player2");
                cell.dataset.state = "2";
                checkWin();
            } else if (state === 2) {
                cell.classList.remove("player2");
                cell.dataset.state = "3";
            } else if (state === 3) {
                resetBoard();
            }
        }
        
        function checkWin() {
            for (let col = 1; col < size - 1; col++) {
                if (dfs(1, col, "player1", new Set())) {
                    message.innerText = "اللاعب الأزرق فاز!";
                    disableBoard();
                    return;
                }
            }
            
            for (let row = 1; row < size - 1; row++) {
                if (dfs(row, 1, "player2", new Set())) {
                    message.innerText = "اللاعب الأحمر فاز!";
                    disableBoard();
                    return;
                }
            }
        }
        
        function dfs(row, col, player, visited) {
            if (row < 0 || row >= size || col < 0 || col >= size || visited.has(`${row},${col}`)) return false;
            let cell = grid[row][col];
            if (!cell.classList.contains(player)) return false;
            
            visited.add(`${row},${col}`);
            
            if (player === "player1" && row === size - 2) return true;
            if (player === "player2" && col === size - 2) return true;
            
            const directions = [
                [-1, 0], [1, 0], [0, -1], [0, 1], [-1, 1], [1, -1]
            ];
            
            for (let [dr, dc] of directions) {
                if (dfs(row + dr, col + dc, player, visited)) return true;
            }
            return false;
        }
        
        function disableBoard() {
            for (let row = 1; row < size - 1; row++) {
                for (let col = 1; col < size - 1; col++) {
                    grid[row][col].removeEventListener("click", selectCell);
                }
            }
        }
        
        function resetBoard() {
            usedLetters.clear();
            for (let row = 1; row < size - 1; row++) {
                for (let col = 1; col < size - 1; col++) {
                    let cell = grid[row][col];
                    let letter;
                    do {
                        letter = letters[Math.floor(Math.random() * letters.length)];
                    } while (usedLetters.has(letter));
                    usedLetters.add(letter);
                    cell.innerText = letter;
                    cell.classList.remove("player1", "player2");
                    cell.dataset.state = "0";
                    cell.addEventListener("click", () => selectCell(cell));
                }
            }
            message.innerText = "";
        }
        
        createBoard();
    </script>
</body>
</html>
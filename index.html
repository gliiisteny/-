<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>حروفكم مع عبدالعزيز</title>
    <style>
        body { text-align: center; font-family: Arial, sans-serif; background: #1a1a1a; color: #fff; }
        h1 { color: #00ccff; text-shadow: 0 0 10px #00ccff; }
        p { font-size: 18px; }
        .grid { 
            display: flex; flex-wrap: wrap; justify-content: center; 
            width: 600px; margin: 30px auto; position: relative; 
        }
        .hex { 
            width: 90px; height: 90px; 
            background: #333; 
            display: flex; align-items: center; justify-content: center; 
            border: 3px solid #fff; 
            clip-path: polygon(50% 0%, 95% 25%, 95% 75%, 50% 100%, 5% 75%, 5% 25%); 
            cursor: pointer; font-size: 32px; font-weight: bold; 
            color: #ffd700; font-family: 'Arial Black', sans-serif; 
            transition: transform 0.2s, background 0.3s; 
            margin: 2px; 
        }
        .hex:hover { transform: scale(1.1); }
        .player1 { background: #00b7eb; color: #fff; border-color: #00e6ff; } /* أزرق */
        .player2 { background: #ffcc00; color: #fff; border-color: #ffe066; } /* أصفر */
        .edge-blue { background: #0077b6 !important; border-color: #00b7eb; }
        .edge-yellow { background: #cc9900 !important; border-color: #ffcc00; }
        #message { margin-top: 20px; font-size: 24px; font-weight: bold; }
        #resetButton { 
            background: #ff4040; color: #fff; padding: 10px 20px; 
            border: none; border-radius: 5px; font-size: 18px; 
            cursor: pointer; margin-top: 20px; 
        }
        #resetButton:hover { background: #ff6666; }
    </style>
</head>
<body>
    <h1>حروفكم مع عبدالعزيز</h1>
    <p>اضغط على الخلية لتحديدها. الأزرق يفوز عند الربط عموديًا، والأصفر يفوز عند الربط أفقيًا!</p>
    <div class="grid" id="board"></div>
    <button id="resetButton">تجديد الخلايا</button>
    <div id="message"></div>
    <script>
        const letters = ["ا", "ب", "ت", "ث", "ج", "ح", "خ", "د", "ذ", "ر", "ز", "س", "ش", "ص", "ض", "ط", "ظ", "ع", "غ", "ف", "ق", "ك", "ل", "م", "ن", "ه", "و", "ي"];
        const board = document.getElementById("board");
        const message = document.getElementById("message");
        const resetButton = document.getElementById("resetButton");
        const rows = [3, 4, 5, 6, 5, 4, 3]; // شكل سداسي
        let grid = [];
        let usedLetters = new Set();

        function createBoard() {
            usedLetters.clear();
            board.innerHTML = "";
            grid = [];
            let cellIndex = 0;

            for (let row = 0; row < rows.length; row++) {
                grid[row] = [];
                let offset = (6 - rows[row]) * 45; // محاذاة الصفوف لتشكيل سداسي
                for (let col = 0; col < rows[row]; col++) {
                    let cell = document.createElement("div");
                    cell.classList.add("hex");
                    cell.dataset.row = row;
                    cell.dataset.col = col;
                    cell.dataset.clicks = "0";
                    cell.style.marginLeft = row === 0 ? `${offset}px` : "2px";

                    if (row === 0 || row === rows.length - 1) {
                        cell.classList.add("edge-blue");
                    } else if (col === 0 || col === rows[row] - 1) {
                        cell.classList.add("edge-yellow");
                    } else {
                        let letter;
                        do {
                            letter = letters[Math.floor(Math.random() * letters.length)];
                        } while (usedLetters.has(letter));
                        usedLetters.add(letter);
                        cell.innerText = letter;
                        cell.addEventListener("click", () => selectCell(cell));
                    }

                    board.appendChild(cell);
                    grid[row][col] = cell;
                    cellIndex++;
                }
            }
        }

        function selectCell(cell) {
            let clicks = parseInt(cell.dataset.clicks) + 1;
            cell.dataset.clicks = clicks;

            cell.classList.remove("player1", "player2");

            if (clicks === 10) {
                usedLetters.delete(cell.innerText);
                let newLetter;
                do {
                    newLetter = letters[Math.floor(Math.random() * letters.length)];
                } while (usedLetters.has(newLetter));
                usedLetters.add(newLetter);
                cell.innerText = newLetter;
                cell.dataset.clicks = "0";
            } else if (clicks % 2 === 1) {
                cell.classList.add("player1"); // أزرق
            } else {
                cell.classList.add("player2"); // أصفر
            }

            checkWin();
        }

        function checkWin() {
            for (let col = 1; col < rows[1] - 1; col++) {
                if (dfs(1, col, "player1", new Set())) {
                    message.innerText = "اللاعب الأزرق فاز!";
                    disableBoard();
                    return;
                }
            }

            for (let row = 1; row < rows.length - 1; row++) {
                if (dfs(row, 1, "player2", new Set())) {
                    message.innerText = "اللاعب الأصفر فاز!";
                    disableBoard();
                    return;
                }
            }
        }

        function dfs(row, col, player, visited) {
            if (row < 0 || row >= rows.length || col < 0 || col >= rows[row] || visited.has(`${row},${col}`)) return false;
            let cell = grid[row][col];
            if (!cell.classList.contains(player)) return false;

            visited.add(`${row},${col}`);

            if (player === "player1" && row === rows.length - 2) return true;
            if (player === "player2" && col === rows[row] - 2) return true;

            const directions = [
                [-1, 0], [1, 0], [0, -1], [0, 1], [-1, 1], [1, -1]
            ];

            for (let [dr, dc] of directions) {
                if (dfs(row + dr, col + dc, player, visited)) return true;
            }
            return false;
        }

        function disableBoard() {
            for (let row = 1; row < rows.length - 1; row++) {
                for (let col = 1; col < rows[row] - 1; col++) {
                    grid[row][col].removeEventListener("click", selectCell);
                }
            }
        }

        function resetBoard() {
            createBoard(); // إعادة إنشاء اللوحة بالكامل
            message.innerText = "";
        }

        resetButton.addEventListener("click", resetBoard);

        createBoard();
    </script>
</body>
</html>
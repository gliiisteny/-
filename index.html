<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>لعبة المسابقات</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            font-family: Arial, sans-serif;
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            background-color: beige;
        }
        .card {
            padding: 1.5rem;
            background-color: white;
            color: black;
            text-align: center;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        .start-box {
            width: 300px;
            height: 200px;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        .button {
            padding: 0.5rem 1rem;
            margin: 0.25rem;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            background-color: #3b82f6;
            color: white;
        }
        .button:hover {
            background-color: #2563eb;
        }
        .button:disabled {
            background-color: #9ca3af;
            cursor: not-allowed;
        }
        .button-green {
            background-color: #22c55e;
        }
        .button-gray {
            background-color: #d1d5db;
        }
        .input {
            padding: 0.5rem;
            margin: 0.5rem 0;
            width: 100%;
            box-sizing: border-box;
            border: 1px solid #d1d5db;
            border-radius: 4px;
        }
        .grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 0.5rem;
            margin-top: 1rem;
        }
        .team-container {
            display: flex;
            justify-content: space-between;
            gap: 1rem;
        }
        .category-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1rem;
            padding: 1rem;
            position: relative;
            height: 100%;
            width: 100%;
        }
        .category-box {
            border: 1px solid #d1d5db;
            padding: 1rem;
            border-radius: 8px;
        }
        .category-box h3 {
            font-size: 1.5rem;
            margin-bottom: 1rem;
        }
        .points-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 0.5rem;
        }
        .question-card {
            position: absolute;
            width: 50%;
            border: 4px solid #ef4444;
            z-index: 10;
        }
        .timer {
            color: #ef4444;
            text-align: right;
            font-size: 0.875rem;
            margin-top: 1rem;
        }
        .score-box {
            position: absolute;
            top: 10px;
            right: 10px;
            width: 200px;
            padding: 1rem;
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script src="https://unpkg.com/react@18.2.0/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18.2.0/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone@7.23.2/babel.min.js"></script>

    <script type="text/babel">
        function QuizGame() {
            const [screen, setScreen] = React.useState("start");
            const [teams, setTeams] = React.useState({ left: "", right: "" });
            const [competitionName, setCompetitionName] = React.useState("");
            const [selectedCategories, setSelectedCategories] = React.useState([]);
            const [selectedQuestion, setSelectedQuestion] = React.useState(null);
            const [score, setScore] = React.useState({ left: 0, right: 0 });
            const [timeLeft, setTimeLeft] = React.useState(120);
            const [showAnswer, setShowAnswer] = React.useState(false);
            const [answeredQuestions, setAnsweredQuestions] = React.useState({});

            const allCategories = [
                "كرة القدم", "القرآن الكريم", "التاريخ الإسلامي", "شخصيات تاريخية",
                "أفلام", "مسلسلات", "عواصم", "دول", "معلومات عامة", "ألغاز", "حيوانات"
            ];

            // هيكلية الأسئلة (ستضيفين الأسئلة لاحقًا)
            const questions = {
                "كرة القدم": [
                    { points: 100, question: "سؤال 1", answer: "إجابة 1" },
                    { points: 200, question: "سؤال 2", answer: "إجابة 2" },
                    { points: 300, question: "سؤال 3", answer: "إجابة 3" },
                    { points: 400, question: "سؤال 4", answer: "إجابة 4" },
                ],
                "القرآن الكريم": [
                    { points: 100, question: "سؤال 1", answer: "إجابة 1" },
                    { points: 200, question: "سؤال 2", answer: "إجابة 2" },
                    { points: 300, question: "سؤال 3", answer: "إجابة 3" },
                    { points: 400, question: "سؤال 4", answer: "إجابة 4" },
                ],
                // أضيفي بقية الفئات بنفس الطريقة
            };

            React.useEffect(() => {
                if (selectedQuestion && timeLeft > 0) {
                    const timer = setInterval(() => setTimeLeft(timeLeft - 1), 1000);
                    return () => clearInterval(timer);
                }
            }, [selectedQuestion, timeLeft]);

            return (
                <div style={{ width: "100%", height: "100%", position: "relative" }}>
                    {screen === "start" && (
                        <div className="card start-box">
                            <button 
                                className="button" 
                                onClick={() => setScreen("setup")}
                            >
                                البدء
                            </button>
                        </div>
                    )}

                    {screen === "setup" && (
                        <div className="card" style={{ width: "75%" }}>
                            <input
                                type="text"
                                placeholder="اسم المسابقة"
                                className="input"
                                value={competitionName}
                                onChange={(e) => setCompetitionName(e.target.value)}
                            />
                            <div className="team-container">
                                <input
                                    type="text"
                                    placeholder="اسم الفريق الأيسر"
                                    className="input"
                                    value={teams.left}
                                    onChange={(e) => setTeams({ ...teams, left: e.target.value })}
                                />
                                <input
                                    type="text"
                                    placeholder="اسم الفريق الأيمن"
                                    className="input"
                                    value={teams.right}
                                    onChange={(e) => setTeams({ ...teams, right: e.target.value })}
                                />
                            </div>
                            <button 
                                className="button" 
                                onClick={() => setScreen("categories")}
                                disabled={!teams.left || !teams.right || !competitionName}
                            >
                                البدء
                            </button>
                        </div>
                    )}

                    {screen === "categories" && (
                        <div className="card" style={{ width: "75%" }}>
                            <h2 style={{ marginBottom: "1rem" }}>{competitionName}</h2>
                            <div className="grid">
                                {allCategories.map((cat, index) => (
                                    <button
                                        key={index}
                                        className={`button ${selectedCategories.includes(cat) ? 'button-green' : 'button-gray'}`}
                                        style={{ fontSize: "1.5rem" }}
                                        onClick={() => {
                                            if (selectedCategories.includes(cat)) {
                                                setSelectedCategories(selectedCategories.filter(c => c !== cat));
                                            } else if (selectedCategories.length < 6) {
                                                setSelectedCategories([...selectedCategories, cat]);
                                            }
                                        }}
                                    >
                                        {cat}
                                    </button>
                                ))}
                            </div>
                            {selectedCategories.length === 0 && (
                                <p style={{ color: "#ef4444", marginTop: "1rem" }}>
                                    يرجى اختيار فئة واحدة على الأقل
                                </p>
                            )}
                            {selectedCategories.length > 0 && (
                                <button 
                                    className="button" 
                                    style={{ marginTop: "1rem" }}
                                    onClick={() => setScreen("questions")}
                                >
                                    الانطلاق
                                </button>
                            )}
                        </div>
                    )}

                    {screen === "questions" && (
                        <div style={{ width: "100%", height: "100%", position: "relative" }}>
                            <div className="category-grid">
                                {selectedCategories.map((cat, index) => (
                                    <div 
                                        key={index} 
                                        className="category-box"
                                        style={{
                                            gridColumn: index % 2 === 0 ? 1 : 2,
                                            gridRow: Math.floor(index / 2) + 1,
                                        }}
                                    >
                                        <h3>{cat}</h3>
                                        <div className="points-grid">
                                            {[100, 200, 300, 400].map((pt, i) => (
                                                <button
                                                    key={i}
                                                    className={`button ${answeredQuestions[`${cat}-${pt}`] ? 'button-gray' : ''}`}
                                                    disabled={answeredQuestions[`${cat}-${pt}`]}
                                                    onClick={() => {
                                                        const q = questions[cat]?.[i] || { question: "سؤال افتراضي", answer: "إجابة افتراضية", points: pt };
                                                        setSelectedQuestion({ ...q, category: cat });
                                                        setTimeLeft(120);
                                                        setShowAnswer(false);
                                                        setAnsweredQuestions({ ...answeredQuestions, [`${cat}-${pt}`]: true });
                                                        setScreen("question");
                                                    }}
                                                >
                                                    {pt}
                                                </button>
                                            ))}
                                        </div>
                                    </div>
                                ))}
                            </div>
                            <div className="score-box">
                                <h4>لوحة النتائج</h4>
                                <p>{teams.left}: {score.left}</p>
                                <p>{teams.right}: {score.right}</p>
                            </div>
                        </div>
                    )}

                    {screen === "question" && selectedQuestion && (
                        <div className="card question-card">
                            <p style={{ textAlign: "center", marginBottom: "1rem" }}>
                                {showAnswer ? selectedQuestion.answer : selectedQuestion.question}
                            </p>
                            <p className="timer">⏳ {timeLeft} ثانية</p>
                            <div style={{ display: "flex", justifyContent: "space-between", marginTop: "1rem" }}>
                                {!showAnswer ? (
                                    <button 
                                        className="button" 
                                        onClick={() => setShowAnswer(true)}
                                    >
                                        اظهر الإجابة
                                    </button>
                                ) : (
                                    <div style={{ width: "100%", textAlign: "center" }}>
                                        <p>من صاحب الإجابة الصحيحة؟</p>
                                        <button
                                            className="button"
                                            style={{ margin: "0.5rem" }}
                                            onClick={() => {
                                                setScore({ ...score, left: score.left + selectedQuestion.points });
                                                setScreen("questions");
                                            }}
                                        >
                                            {teams.left}
                                        </button>
                                        <button
                                            className="button"
                                            style={{ margin: "0.5rem" }}
                                            onClick={() => {
                                                setScore({ ...score, right: score.right + selectedQuestion.points });
                                                setScreen("questions");
                                            }}
                                        >
                                            {teams.right}
                                        </button>
                                    </div>
                                )}
                                <button 
                                    className="button" 
                                    onClick={() => setScreen("questions")}
                                >
                                    العودة
                                </button>
                            </div>
                        </div>
                    )}
                </div>
            );
        }

        if (window.React && window.ReactDOM) {
            ReactDOM.render(<QuizGame />, document.getElementById('root'));
        } else {
            console.error("React أو ReactDOM لم يتم تحميلهما!");
        }
    </script>
</body>
</html>
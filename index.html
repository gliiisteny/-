    function createBoard() {
        usedLetters.clear();
        board.innerHTML = "";
        grid = [];

        for (let row = 0; row < size; row++) {
            grid[row] = [];
            for (let col = 0; col < size; col++) {
                let cell = document.createElement("div");
                cell.classList.add("hex");
                cell.dataset.row = row;
                cell.dataset.col = col;
                cell.dataset.clicks = "0";

                if (row === 0 || row === size - 1) {
                    cell.classList.add("edge-blue");
                } else if (col === 0 || col === size - 1) {
                    cell.classList.add("edge-yellow");
                } else {
                    let letter;
                    do {
                        letter = letters[Math.floor(Math.random() * letters.length)];
                    } while (usedLetters.has(letter));
                    usedLetters.add(letter);
                    cell.innerText = letter;
                    cell.addEventListener("click", () => selectCell(cell));
                }

                board.appendChild(cell);
                grid[row][col] = cell;
            }
        }
    }

    function selectCell(cell) {
        let clicks = parseInt(cell.dataset.clicks) + 1;
        cell.dataset.clicks = clicks;

        cell.classList.remove("player1", "player2");

        if (clicks === 10) {
            usedLetters.delete(cell.innerText);
            let newLetter;
            do {
                newLetter = letters[Math.floor(Math.random() * letters.length)];
            } while (usedLetters.has(newLetter));
            usedLetters.add(newLetter);
            cell.innerText = newLetter;
            cell.dataset.clicks = "0";
        } else if (clicks % 2 === 1) {
            cell.classList.add("player1"); // أزرق
        } else {
            cell.classList.add("player2"); // أصفر
        }

        checkWin();
    }

    function checkWin() {
        for (let col = 1; col < size - 1; col++) {
            if (dfs(1, col, "player1", new Set())) {
                message.innerText = "اللاعب الأزرق فاز!";
                disableBoard();
                return;
            }
        }

        for (let row = 1; row < size - 1; row++) {
            if (dfs(row, 1, "player2", new Set())) {
                message.innerText = "اللاعب الأصفر فاز!";
                disableBoard();
                return;
            }
        }
    }

    function dfs(row, col, player, visited) {
        if (row < 0 || row >= size || col < 0 || col >= size || visited.has(`${row},${col}`)) return false;
        let cell = grid[row][col];
        if (!cell.classList.contains(player)) return false;

        visited.add(`${row},${col}`);

        if (player === "player1" && row === size - 2) return true;
        if (player === "player2" && col === size - 2) return true;

        const directions = [
            [-1, 0], [1, 0], [0, -1], [0, 1], [-1, 1], [1, -1]
        ];

        for (let [dr, dc] of directions) {
            if (dfs(row + dr, col + dc, player, visited)) return true;
        }
        return false;
    }

    function disableBoard() {
        for (let row = 1; row < size - 1; row++) {
            for (let col = 1; col < size - 1; col++) {
                grid[row][col].removeEventListener("click", selectCell);
            }
        }
    }

    function resetBoard() {
        createBoard();
        message.innerText = "";
    }

    resetButton.addEventListener("click", resetBoard);

    createBoard();
</script>